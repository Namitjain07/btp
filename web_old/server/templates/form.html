<!DOCTYPE html>
<html>
<head>
    <title>Hotel Data Entry</title>
    <style>
        .error { color: red; margin: 10px 0; }
        .form-group { margin-bottom: 15px; }
        label { font-weight: bold; }
        input { padding: 5px; margin-top: 5px; }
        .submit-btn { background-color: #4CAF50; color: white; padding: 10px 20px; border: none; cursor: pointer; }
        .submit-btn:hover { background-color: #45a049; }
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid #ddd;
        }
        .user-info {
            color: #666;
            font-size: 0.9rem;
        }
        .logout-btn {
            background-color: #f44336;
            color: white;
            padding: 8px 16px;
            border: none;
            cursor: pointer;
            text-decoration: none;
            border-radius: 4px;
        }
        .logout-btn:hover {
            background-color: #da190b;
        }
        .form-container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }
        .form-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }
        .form-group.full-width {
            grid-column: 1 / -1;
        }
        .validation-error {
            color: red;
            font-size: 0.9em;
            margin-top: 5px;
        }
        input:invalid {
            border-color: #f44336;
        }
        input:valid {
            border-color: #4CAF50;
        }
    </style>
</head>
<body>
    <div class="form-container">
        <div class="header">
            <h1>Enter Hotel Data</h1>
            <div>
                {% if user %}
                    <span class="user-info">Logged in as: {{ user }}</span>
                    <a href="/logout" class="logout-btn">Logout</a>
                {% endif %}
            </div>
        </div>
        
        <form action="/submit" method="post" onsubmit="return validateForm()">
            <div class="form-grid">
                <div class="form-group">
                    <label for="Total Room Inventory">Total Room Inventory:</label><br>
                    <input type="number" step="1" min="1" max="10000" name="Total Room Inventory" id="Total Room Inventory" required><br>
                </div>
                
                <div class="form-group">
                    <label for="Rooms Sold">Rooms Sold:</label><br>
                    <input type="number" step="1" min="0" max="10000" name="Rooms Sold" id="Rooms Sold" required><br>
                </div>
                
                <div class="form-group">
                    <label for="Arrival Rooms">Arrival Rooms:</label><br>
                    <input type="number" step="1" min="0" max="10000" name="Arrival Rooms" id="Arrival Rooms" required><br>
                </div>
                
                <div class="form-group">
                    <label for="Compliment Rooms">Compliment Rooms:</label><br>
                    <input type="number" step="1" min="0" max="1000" name="Compliment Rooms" id="Compliment Rooms" required><br>
                </div>
                
                <div class="form-group">
                    <label for="House Use">House Use:</label><br>
                    <input type="number" step="1" min="0" max="1000" name="House Use" id="House Use" required><br>
                </div>
                
                <div class="form-group">
                    <label for="Individual Confirm">Individual Confirm:</label><br>
                    <input type="number" step="1" min="0" max="10000" name="Individual Confirm" id="Individual Confirm" required><br>
                </div>
                
                <div class="form-group">
                    <label for="Occupancy %">Occupancy % (0-100):</label><br>
                    <input type="number" step="0.01" min="0" max="100" name="Occupancy %" id="Occupancy %" required><br>
                </div>
                
                <div class="form-group">
                    <label for="Room Revenue">Room Revenue:</label><br>
                    <input type="number" step="0.01" min="0" max="999999.99" name="Room Revenue" id="Room Revenue" required><br>
                </div>
                
                <div class="form-group">
                    <label for="ARR">ARR (Average Room Rate):</label><br>
                    <input type="number" step="0.01" min="0" max="99999.99" name="ARR" id="ARR" required><br>
                </div>
                
                <div class="form-group">
                    <label for="Departure Rooms">Departure Rooms:</label><br>
                    <input type="number" step="1" min="0" max="10000" name="Departure Rooms" id="Departure Rooms" required><br>
                </div>
                
                <div class="form-group">
                    <label for="OOO Rooms">OOO Rooms (Out of Order):</label><br>
                    <input type="number" step="1" min="0" max="1000" name="OOO Rooms" id="OOO Rooms" required><br>
                </div>
                
                <div class="form-group">
                    <label for="Pax">Pax (Number of Guests):</label><br>
                    <input type="number" step="1" min="0" max="50000" name="Pax" id="Pax" required><br>
                </div>
                
                <div class="form-group">
                    <label for="snapshot_date">Snapshot Date:</label><br>
                    <input type="date" name="snapshot_date" id="snapshot_date" required><br>
                </div>
                
                <div class="form-group">
                    <label for="arrival_date">Arrival Date:</label><br>
                    <input type="date" name="arrival_date" id="arrival_date" required><br>
                </div>
                
                <div class="form-group">
                    <label for="actual_or_forecast">Actual or Forecast:</label><br>
                    <select name="actual_or_forecast" id="actual_or_forecast" required>
                        <option value="">Select...</option>
                        <option value="actual">Actual</option>
                        <option value="forecast">Forecast</option>
                    </select><br>
                </div>
                
                <div class="form-group">
                    <label for="Day">Day of Week:</label><br>
                    <select name="Day" id="Day" required>
                        <option value="">Select...</option>
                        <option value="Monday">Monday</option>
                        <option value="Tuesday">Tuesday</option>
                        <option value="Wednesday">Wednesday</option>
                        <option value="Thursday">Thursday</option>
                        <option value="Friday">Friday</option>
                        <option value="Saturday">Saturday</option>
                        <option value="Sunday">Sunday</option>
                    </select><br>
                </div>
                
                <div class="form-group">
                    <label for="revenue_diff">Revenue Diff:</label><br>
                    <input type="number" step="0.01" min="-999999.99" max="999999.99" name="revenue_diff" id="revenue_diff" required><br>
                </div>
            </div>
            
            <div class="form-group full-width" style="margin-top: 20px;">
                <input type="submit" value="Submit" class="submit-btn">
            </div>
        </form>
    </div>

    <script>
        function validateForm() {
            const form = document.forms[0];
            const errors = [];
            
            // Get values
            const totalInventory = parseInt(form["Total Room Inventory"].value);
            const roomsSold = parseInt(form["Rooms Sold"].value);
            const occupancy = parseFloat(form["Occupancy %"].value);
            const roomRevenue = parseFloat(form["Room Revenue"].value);
            const arr = parseFloat(form["ARR"].value);
            
            // Validate occupancy percentage
            if (occupancy < 0 || occupancy > 100) {
                errors.push("Occupancy percentage must be between 0 and 100");
            }
            
            // Validate rooms sold vs inventory
            if (roomsSold > totalInventory) {
                errors.push("Rooms sold cannot exceed total room inventory");
            }
            
            // Validate revenue fields
            if (roomRevenue < 0) {
                errors.push("Room revenue cannot be negative");
            }
            
            if (arr < 0) {
                errors.push("ARR cannot be negative");
            }
            
            // Validate dates
            const snapshotDate = new Date(form["snapshot_date"].value);
            const arrivalDate = new Date(form["arrival_date"].value);
            
            if (snapshotDate > arrivalDate) {
                errors.push("Snapshot date should not be after arrival date");
            }
            
            // Show errors if any
            if (errors.length > 0) {
                alert("Please fix the following errors:\n\n" + errors.join("\n"));
                return false;
            }
            
            return true;
        }
        
        // Auto-calculate occupancy percentage when inventory or rooms sold change
        function calculateOccupancy() {
            const inventory = parseFloat(document.getElementById("Total Room Inventory").value) || 0;
            const sold = parseFloat(document.getElementById("Rooms Sold").value) || 0;
            
            if (inventory > 0) {
                const occupancy = (sold / inventory * 100).toFixed(2);
                document.getElementById("Occupancy %").value = occupancy;
            }
        }
        
        document.getElementById("Total Room Inventory").addEventListener("input", calculateOccupancy);
        document.getElementById("Rooms Sold").addEventListener("input", calculateOccupancy);
    </script>
</body>
</html>
